#! /bin/bash
set -e

# Exports database for others to download.

MYSQL_DUMP=/software/bin/mysqldump

# Main tables with data from Hansard
$MYSQL_DUMP --add-drop-table francis pw_division pw_moffice pw_mp pw_vote | bzip2 - >~/www.publicwhip.org.uk_html/data/pw_static_tables.sql.bz2

# User edited tables
# DO NOT include pw_dyn_user or pw_dyn_auditlog as they have emails etc. in them
$MYSQL_DUMP --add-drop-table francis pw_dyn_rolliemp pw_dyn_rollievote pw_dyn_wiki | bzip2 - >~/www.publicwhip.org.uk_html/data/pw_dynamic_tables.sql.bz2

# Cache tables.
$MYSQL_DUMP --add-drop-table francis pw_cache_attendrank_today pw_cache_divinfo pw_cache_mpcoords pw_cache_mpdist pw_cache_mpinfo pw_cache_mpinfo_session2002 pw_cache_partyinfo pw_cache_rebelrank_today pw_cache_whip pw_cache_divwiki pw_cache_dreaminfo pw_cache_dreamreal_distance pw_cache_realreal_distance | bzip2 - >~/www.publicwhip.org.uk_html/data/pw_cache_tables.sql.bz2

